{% extends "base.html" %}

{% macro label_number(v) %}
 {{ v }}%{% if v >= 0 %}以上{% else %}以下{% endif %}
{% endmacro %}

{% block content %}
  <script type="text/javascript">
    $(function(){
     $("form").on("change", function(){ location.href = "?" + $("form").serialize(); })
    });
  </script>
  <h2>企業一覧</h2>
  <h3>最終更新日 {{ last_date }}</h3>

  <table>
    <tr>
      <th>企業数</th>
    </tr>
    <tr>
      <td>{{ company_list|length }}</td>
    </tr>
  </table>

  <form action="{{ url_for('index') }}" method="get">
    {% for v in [10, 5, -5, -10] %}
    <input type="radio" name="ratio_closing_minus_rolling_mean_25" value="{{ v }}"
           {% if v|string == request.args.get("ratio_closing_minus_rolling_mean_25") %}checked{% endif %}>
    25日移動平均線 {{ label_number(v) }}
    {% endfor %}
    <br>

    <input type="radio" name="closing_rsi_14" value="70"  {% if request.args.get("closing_rsi_14") == "70" %}checked{% endif %}>
    RSI 70%以上(売り)
    <input type="radio" name="closing_rsi_14" value="-30" {% if request.args.get("closing_rsi_14") == "-30" %}checked{% endif %}>
    RSI 30%以下(買い)
    <br>

    <input type="radio" name="closing_macd_minus_signal" value="1"  {% if request.args.get("closing_macd_minus_signal") == "1" %}checked{% endif %}>
    MACD ゴールデンクロス(買い)
    <input type="radio" name="closing_macd_minus_signal" value="-1" {% if request.args.get("closing_macd_minus_signal") == "-1" %}checked{% endif %}>
    MACD デッドクロス(売り)

  </form>
  <ul>
    {% for c in company_list %}
     <li><a href="{{ url_for('company', id=c.id) }}">{{ c.name }}</a></li>
   {% endfor %}
  </ul>
{% endblock %}
